# Автоматизированная настройка сервера Debian/Ubuntu

Скрипт выполняет комплексную настройку сервера, обеспечивая базовую безопасность, создание пользователя с SSH-доступом, установку ключевых сервисов, автоматизацию обновлений и мониторинг системы.  

## Основные возможности

### 1. Проверка прав
* Скрипт проверяет права пользователя.  
* Завершает работу, если скрипт не запущен от root.

### 2. Настройка карантинной директории ClamAV
* Создаётся директория для заражённых файлов с ограниченным доступом.  
* Директория используется для перемещения заражённых файлов при обнаружении вирусов.

### 3. Установка переменных окружения
* Определяется редактор по умолчанию для работы с текстовыми файлами.

### 4. Конфигурация SSH
* Запрашивается нестандартный SSH-порт и проверяется его доступность.  
* Создаётся новый пользователь с правами sudo.  
* Генерируется случайный пароль.  
* Добавляется публичный SSH-ключ.  
* Настраивается SSH-сервис: отключается вход под root и аутентификация по паролю.  
* Сервис SSH перезапускается для применения настроек.

### 5. Установка пакетов и Docker
* Скрипт проверяет наличие и устанавливает необходимые пакеты для безопасности и работы системы.  
* Устанавливается Docker.

### 6. Автоматическое обновление системы
* Настраивается ежедневная задача для автоматического обновления пакетов и системы.  
* Логи обновлений сохраняются для последующего анализа.

### 7. Настройка брандмауэра (UFW)
* Все входящие соединения блокируются по умолчанию.  
* Разрешается исходящий трафик и доступ к SSH-порту.  
* Брандмауэр активируется автоматически.

### 8. Настройка ClamAV
* Выполняется обновление базы сигнатур антивируса.  
* Создаётся фоновый сервис для постоянного мониторинга директорий, логирования и перемещения заражённых файлов в карантин.  
* Сервис включается и запускается автоматически.

### 9. Настройка Fail2Ban
* Конфигурируется защита SSH и веб-сервера (если установлен).  
* Настраиваются параметры бана, максимальное количество попыток и путь к логам.  
* Сервис включается и запускается автоматически.

### 10. Создание пользователя и управление правами
* Пользователь создаётся с правами sudo.  
* Настраивается домашняя директория и SSH-доступ с публичным ключом.  
* Пароль пользователя генерируется автоматически.

### 11. Проверка и запуск сервисов
* Скрипт проверяет состояние сервисов ClamAV и Fail2Ban.  
* При необходимости сервисы запускаются и включаются на старте системы.

### 12. Логи и мониторинг
* Логи ClamAV и обновлений пакетов сохраняются в системных директориях для последующего анализа и контроля.  

## Результат работы скрипта

После выполнения скрипта сервер получает:

* Созданного пользователя с sudo-доступом, случайным паролем и публичным SSH-ключом.  
* Настроенный SSH на нестандартном порту с отключением паролей и root-доступа.  
* Активный и настроенный брандмауэр UFW.  
* Установленные и работающие ClamAV и Fail2Ban с автоматическим запуском.  
* Фоновый мониторинг файловой системы и карантин для потенциально заражённых файлов.  
* Установленный Docker.  
* Автоматическое обновление пакетов по ночам.

## Инструкция по запуску

Скрипт запускается с правами root и пошагово проводит настройку системы, запрашивая необходимую информацию, такую как SSH-порт, имя пользователя и публичный ключ.  
