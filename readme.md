# Автоматизированная настройка сервера Debian/Ubuntu

Этот скрипт выполняет комплексную настройку сервера на базе Debian/Ubuntu, обеспечивая базовую безопасность, создание пользователя и установку ключевых сервисов.

## Основные возможности

### 1. Проверка прав
Скрипт запускается только с правами root и завершает работу, если права недостаточны.

### 2. Настройка карантинной директории ClamAV
Создаётся директория для перемещения заражённых файлов с ограниченными правами доступа.

### 3. Установка переменных окружения
Определяется редактор по умолчанию для работы с текстовыми файлами.

### 4. Конфигурация SSH
Скрипт запрашивает порт SSH, проверяет его доступность, создаёт нового пользователя с sudo-доступом, генерирует случайный пароль и добавляет публичный SSH-ключ. Настраивается SSH-сервис с отключением входа под root и аутентификации по паролю, после чего сервис перезапускается.

### 5. Установка пакетов и Docker
Проверяется наличие и устанавливаются необходимые пакеты, включая инструменты безопасности, антивирус и утилиты. Дополнительно устанавливается Docker.

### 6. Автоматическое обновление системы
Настраивается ежедневная задача для автоматического обновления пакетов и системы в целом.

### 7. Настройка брандмауэра (UFW)
Блокируются все входящие соединения по умолчанию, разрешается исходящий трафик и доступ к SSH-порту, после чего брандмауэр активируется.

### 8. Настройка ClamAV
Выполняется обновление базы сигнатур, создаётся фоновый сервис для постоянного мониторинга директорий, логирования и перемещения заражённых файлов в карантин.

### 9. Настройка Fail2Ban
Конфигурируется защита SSH и, при наличии, Nginx. Задаются параметры бана, максимальное количество попыток и путь к логам. Сервис включается и запускается автоматически.

### 10. Проверка и запуск сервисов
Скрипт проверяет состояние установленных сервисов и при необходимости запускает их, обеспечивая корректную работу антивируса и Fail2Ban.

## Результат работы скрипта

После выполнения скрипта сервер получает:

* Созданного пользователя с sudo-доступом и публичным SSH-ключом.
* Настроенный SSH на нестандартном порту с отключением паролей и root-доступа.
* Активный и настроенный брандмауэр UFW.
* Установленные и работающие ClamAV и Fail2Ban.
* Установленный Docker.
* Автоматическое обновление пакетов по ночам.